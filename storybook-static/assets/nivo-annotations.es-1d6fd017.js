import{r as g}from"./index-76fb7be0.js";import{g as C}from"./_commonjsHelpers-de833af9.js";import{h as A,b as I,a as $,i as D}from"./_baseIsEqual-83a59b7a.js";import{_ as G}from"./_baseEach-997447e4.js";import{a as R}from"./_baseForOwn-af9f9dd7.js";import{a as N,b as M,c as q,d as K}from"./hasIn-bc1d64c1.js";import{_ as J,a as U}from"./_baseClone-058cc0a2.js";import{q as Y,r as B,u as W,k as m}from"./viridis-86f79054.js";import{b as X}from"./_basePickBy-65d675d2.js";import{i as Z}from"./isString-addf3cb0.js";import{l as V,n as H,s as Q,E as v,Z as w,$ as tt,o as nt}from"./nivo-colors.es-6a419262.js";import{j as l}from"./jsx-runtime-ffb262ed.js";var et=G;function it(t,i){var o=[];return et(t,function(e,n,a){i(e,n,a)&&o.push(e)}),o}var ot=it,at=A,rt=ot,st=R,lt=I;function ut(t,i){var o=lt(t)?at:rt;return o(t,st(i))}var ht=ut;const ct=C(ht);var dt=$,ft=D,mt="[object Number]";function yt(t){return typeof t=="number"||ft(t)&&dt(t)==mt}var xt=yt;const z=C(xt);function gt(t,i,o){var e=-1,n=t.length;i<0&&(i=-i>n?0:n+i),o=o>n?n:o,o<0&&(o+=n),n=i>o?0:o-i>>>0,i>>>=0;for(var a=Array(n);++e<n;)a[e]=t[e+i];return a}var pt=gt,bt=N,vt=pt;function kt(t,i){return i.length<2?t:bt(t,vt(i,0,-1))}var Wt=kt,wt=M,_t=Y,jt=Wt,Ot=q;function Ct(t,i){return i=wt(i,t),t=jt(t,i),t==null||delete t[Ot(_t(i))]}var Pt=Ct,Et=Z;function zt(t){return Et(t)?void 0:t}var St=zt,Ft=K,Mt=U,Lt=Pt,Tt=M,At=X,It=St,$t=B,Dt=J,Gt=1,Rt=2,Nt=4,qt=$t(function(t,i){var o={};if(t==null)return o;var e=!1;i=Ft(i,function(a){return a=Tt(a,t),e||(e=a.length>1),a}),At(t,Dt(t),o),e&&(o=Mt(o,Gt|Rt|Nt,It));for(var n=i.length;n--;)Lt(o,i[n]);return o}),Kt=qt;const L=C(Kt);function f(){return f=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])}return t},f.apply(this,arguments)}var j={dotSize:4,noteWidth:120,noteTextOffset:8,animate:!0},Jt=function(t){var i=typeof t;return g.isValidElement(t)||i==="string"||i==="function"||i==="object"},Ut=function(t){var i=typeof t;return i==="string"||i==="function"},p=function(t){return t.type==="circle"},O=function(t){return t.type==="dot"},b=function(t){return t.type==="rect"},Yt=function(t){var i=t.data,o=t.annotations,e=t.getPosition,n=t.getDimensions;return o.reduce(function(a,r){var s=r.offset||0;return[].concat(a,ct(i,r.match).map(function(u){var h=e(u),d=n(u);return(p(r)||b(r))&&(d.size=d.size+2*s,d.width=d.width+2*s,d.height=d.height+2*s),f({},L(r,["match","offset"]),h,d,{size:r.size||d.size,datum:u})}))},[])},Bt=function(t,i,o,e){var n=Math.atan2(e-i,o-t);return Q(nt(n))},T=function(t){var i,o,e=t.x,n=t.y,a=t.noteX,r=t.noteY,s=t.noteWidth,u=s===void 0?j.noteWidth:s,h=t.noteTextOffset,d=h===void 0?j.noteTextOffset:h;if(z(a))i=e+a;else{if(a.abs===void 0)throw new Error("noteX should be either a number or an object containing an 'abs' property");i=a.abs}if(z(r))o=n+r;else{if(r.abs===void 0)throw new Error("noteY should be either a number or an object containing an 'abs' property");o=r.abs}var c=e,y=n,k=Bt(e,n,i,o);if(p(t)){var P=V(H(k),t.size/2);c+=P.x,y+=P.y}if(b(t)){var x=Math.round((k+90)/45)%8;x===0&&(y-=t.height/2),x===1&&(c+=t.width/2,y-=t.height/2),x===2&&(c+=t.width/2),x===3&&(c+=t.width/2,y+=t.height/2),x===4&&(y+=t.height/2),x===5&&(c-=t.width/2,y+=t.height/2),x===6&&(c-=t.width/2),x===7&&(c-=t.width/2,y-=t.height/2)}var E=i,_=i;return(k+90)%360>180?(E-=u,_-=u):_+=u,{points:[[c,y],[i,o],[_,o]],text:[E,o-d],angle:k+90}},fn=function(t){var i=t.data,o=t.annotations,e=t.getPosition,n=t.getDimensions;return g.useMemo(function(){return Yt({data:i,annotations:o,getPosition:e,getDimensions:n})},[i,o,e,n])},mn=function(t){var i=t.annotations;return g.useMemo(function(){return i.map(function(o){return f({},o,{computed:T(f({},o))})})},[i])},Xt=function(t){return g.useMemo(function(){return T(t)},[t])},Zt=function(t){var i=t.datum,o=t.x,e=t.y,n=t.note,a=v(),r=w(),s=r.animate,u=r.config,h=W({x:o,y:e,config:u,immediate:!s});return typeof n=="function"?g.createElement(n,{x:o,y:e,datum:i}):l.jsxs(l.Fragment,{children:[a.annotations.text.outlineWidth>0&&l.jsx(m.text,{x:h.x,y:h.y,style:f({},a.annotations.text,{strokeLinejoin:"round",strokeWidth:2*a.annotations.text.outlineWidth,stroke:a.annotations.text.outlineColor}),children:n}),l.jsx(m.text,{x:h.x,y:h.y,style:L(a.annotations.text,["outlineWidth","outlineColor"]),children:n})]})},S=function(t){var i=t.points,o=t.isOutline,e=o!==void 0&&o,n=v(),a=g.useMemo(function(){var u=i[0];return i.slice(1).reduce(function(h,d){return h+" L"+d[0]+","+d[1]},"M"+u[0]+","+u[1])},[i]),r=tt(a);if(e&&n.annotations.link.outlineWidth<=0)return null;var s=f({},n.annotations.link);return e&&(s.strokeLinecap="square",s.strokeWidth=n.annotations.link.strokeWidth+2*n.annotations.link.outlineWidth,s.stroke=n.annotations.link.outlineColor,s.opacity=n.annotations.link.outlineOpacity),l.jsx(m.path,{fill:"none",d:r,style:s})},Vt=function(t){var i=t.x,o=t.y,e=t.size,n=v(),a=w(),r=a.animate,s=a.config,u=W({x:i,y:o,radius:e/2,config:s,immediate:!r});return l.jsxs(l.Fragment,{children:[n.annotations.outline.outlineWidth>0&&l.jsx(m.circle,{cx:u.x,cy:u.y,r:u.radius,style:f({},n.annotations.outline,{fill:"none",strokeWidth:n.annotations.outline.strokeWidth+2*n.annotations.outline.outlineWidth,stroke:n.annotations.outline.outlineColor,opacity:n.annotations.outline.outlineOpacity})}),l.jsx(m.circle,{cx:u.x,cy:u.y,r:u.radius,style:n.annotations.outline})]})},Ht=function(t){var i=t.x,o=t.y,e=t.size,n=e===void 0?j.dotSize:e,a=v(),r=w(),s=r.animate,u=r.config,h=W({x:i,y:o,radius:n/2,config:u,immediate:!s});return l.jsxs(l.Fragment,{children:[a.annotations.outline.outlineWidth>0&&l.jsx(m.circle,{cx:h.x,cy:h.y,r:h.radius,style:f({},a.annotations.outline,{fill:"none",strokeWidth:2*a.annotations.outline.outlineWidth,stroke:a.annotations.outline.outlineColor,opacity:a.annotations.outline.outlineOpacity})}),l.jsx(m.circle,{cx:h.x,cy:h.y,r:h.radius,style:a.annotations.symbol})]})},Qt=function(t){var i=t.x,o=t.y,e=t.width,n=t.height,a=t.borderRadius,r=a===void 0?6:a,s=v(),u=w(),h=u.animate,d=u.config,c=W({x:i-e/2,y:o-n/2,width:e,height:n,config:d,immediate:!h});return l.jsxs(l.Fragment,{children:[s.annotations.outline.outlineWidth>0&&l.jsx(m.rect,{x:c.x,y:c.y,rx:r,ry:r,width:c.width,height:c.height,style:f({},s.annotations.outline,{fill:"none",strokeWidth:s.annotations.outline.strokeWidth+2*s.annotations.outline.outlineWidth,stroke:s.annotations.outline.outlineColor,opacity:s.annotations.outline.outlineOpacity})}),l.jsx(m.rect,{x:c.x,y:c.y,rx:r,ry:r,width:c.width,height:c.height,style:s.annotations.outline})]})},yn=function(t){var i=t.datum,o=t.x,e=t.y,n=t.note,a=Xt(t);if(!Jt(n))throw new Error("note should be a valid react element");return l.jsxs(l.Fragment,{children:[l.jsx(S,{points:a.points,isOutline:!0}),p(t)&&l.jsx(Vt,{x:o,y:e,size:t.size}),O(t)&&l.jsx(Ht,{x:o,y:e,size:t.size}),b(t)&&l.jsx(Qt,{x:o,y:e,width:t.width,height:t.height,borderRadius:t.borderRadius}),l.jsx(S,{points:a.points}),l.jsx(Zt,{datum:i,x:a.text[0],y:a.text[1],note:n})]})},F=function(t,i){i.forEach(function(o,e){var n=o[0],a=o[1];e===0?t.moveTo(n,a):t.lineTo(n,a)})},xn=function(t,i){var o=i.annotations,e=i.theme;o.length!==0&&(t.save(),o.forEach(function(n){if(!Ut(n.note))throw new Error("note is invalid for canvas implementation");e.annotations.link.outlineWidth>0&&(t.lineCap="square",t.strokeStyle=e.annotations.link.outlineColor,t.lineWidth=e.annotations.link.strokeWidth+2*e.annotations.link.outlineWidth,t.beginPath(),F(t,n.computed.points),t.stroke(),t.lineCap="butt"),p(n)&&e.annotations.outline.outlineWidth>0&&(t.strokeStyle=e.annotations.outline.outlineColor,t.lineWidth=e.annotations.outline.strokeWidth+2*e.annotations.outline.outlineWidth,t.beginPath(),t.arc(n.x,n.y,n.size/2,0,2*Math.PI),t.stroke()),O(n)&&e.annotations.symbol.outlineWidth>0&&(t.strokeStyle=e.annotations.symbol.outlineColor,t.lineWidth=2*e.annotations.symbol.outlineWidth,t.beginPath(),t.arc(n.x,n.y,n.size/2,0,2*Math.PI),t.stroke()),b(n)&&e.annotations.outline.outlineWidth>0&&(t.strokeStyle=e.annotations.outline.outlineColor,t.lineWidth=e.annotations.outline.strokeWidth+2*e.annotations.outline.outlineWidth,t.beginPath(),t.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),t.stroke()),t.strokeStyle=e.annotations.link.stroke,t.lineWidth=e.annotations.link.strokeWidth,t.beginPath(),F(t,n.computed.points),t.stroke(),p(n)&&(t.strokeStyle=e.annotations.outline.stroke,t.lineWidth=e.annotations.outline.strokeWidth,t.beginPath(),t.arc(n.x,n.y,n.size/2,0,2*Math.PI),t.stroke()),O(n)&&(t.fillStyle=e.annotations.symbol.fill,t.beginPath(),t.arc(n.x,n.y,n.size/2,0,2*Math.PI),t.fill()),b(n)&&(t.strokeStyle=e.annotations.outline.stroke,t.lineWidth=e.annotations.outline.strokeWidth,t.beginPath(),t.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),t.stroke()),typeof n.note=="function"?n.note(t,{datum:n.datum,x:n.computed.text[0],y:n.computed.text[1],theme:e}):(t.font=e.annotations.text.fontSize+"px "+e.annotations.text.fontFamily,t.textAlign="left",t.textBaseline="alphabetic",t.fillStyle=e.annotations.text.fill,t.strokeStyle=e.annotations.text.outlineColor,t.lineWidth=2*e.annotations.text.outlineWidth,e.annotations.text.outlineWidth>0&&(t.lineJoin="round",t.strokeText(n.note,n.computed.text[0],n.computed.text[1]),t.lineJoin="miter"),t.fillText(n.note,n.computed.text[0],n.computed.text[1]))}),t.restore())};export{xn as J,yn as R,fn as S,mn as j};
